# Sausage Store

![image](https://user-images.githubusercontent.com/9394918/121517767-69db8a80-c9f8-11eb-835a-e98ca07fd995.png)

# üê≥ DevOps-–ø—Ä–æ–µ–∫—Ç: Docker Deployment ‚Äî "–°–æ—Å–∏—Å–æ—á–Ω–∞—è"

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç **—Å–±–æ—Ä–∫—É –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "–°–æ—Å–∏—Å–æ—á–Ω–∞—è"** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Docker**, **Nginx** –∏ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ SSH**. –¶–µ–ª—å ‚Äî —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ production-–ø–æ–¥–æ–±–Ω—É—é —Å—Ä–µ–¥—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CI/CD –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞–∫ –∫–æ–¥–∞.

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç:
- **Frontend** ‚Äî –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ Node.js
- **Nginx** ‚Äî –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** ‚Äî —á–µ—Ä–µ–∑ GitLab CI/CD –∏ shell-—Å–∫—Ä–∏–ø—Ç—ã

---

## üåê –î–µ–º–æ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:  
üëâ [http://std-ext-016-02.praktikum-services.tech](http://std-ext-016-02.praktikum-services.tech)

> ‚ö†Ô∏è –°—Ä–µ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö ‚Äî –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è       | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------------|-----------|
| **Docker**       | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ |
| **Dockerfile**   | –û–ø–∏—Å–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ –¥–ª—è —Å–±–æ—Ä–∫–∏ |
| **Nginx**        | –í–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ reverse proxy |
| **GitLab CI/CD** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –∏ –¥–µ–ø–ª–æ–π |
| **SSH**          | –î–æ—Å—Ç–∞–≤–∫–∞ –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä |
| **Shell-—Å–∫—Ä–∏–ø—Ç—ã**| –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (`deploy.sh`) |

---

## üì¶ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

User ‚Üí HTTP ‚Üí Nginx (–ø—Ä–æ–∫—Å–∏) ‚Üí Frontend (Docker)
‚Üì
–ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ /api ‚Üí –í–Ω–µ—à–Ω–∏–π backend

- Frontend –∏ Nginx –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.
- Nginx –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏–∫—É –∏ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç `/api/*` –Ω–∞ –≤–Ω–µ—à–Ω–∏–π backend.
- –û–±—Ä–∞–∑—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∏ –ø—É—à–∞—Ç—Å—è –≤ GitLab Container Registry.
- –î–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–π –í–ú —á–µ—Ä–µ–∑ SSH.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

docker/
‚îú‚îÄ‚îÄ frontend/
‚îÇ ‚îú‚îÄ‚îÄ Dockerfile # –°–±–æ—Ä–∫–∞ frontend-–æ–±—Ä–∞–∑–∞
‚îÇ ‚îî‚îÄ‚îÄ .dockerignore
‚îú‚îÄ‚îÄ nginx/
‚îÇ ‚îú‚îÄ‚îÄ Dockerfile # –ö–∞—Å—Ç–æ–º–Ω—ã–π –æ–±—Ä–∞–∑ Nginx
‚îÇ ‚îî‚îÄ‚îÄ nginx.conf # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ .gitlab-ci.yml # –ü–∞–π–ø–ª–∞–π–Ω CI/CD
‚îî‚îÄ‚îÄ deploy.sh # –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä


---

## üèóÔ∏è –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤

### ‚úÖ Frontend
- –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞:
  1. –°–±–æ—Ä–∫–∞ (`npm install`, `npm run build`)
  2. –§–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ –Ω–∞ `nginx:alpine` —Å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º `dist/`
- –û–±—Ä–∞–∑: `registry.gitlab.com/lolliuym/yandex-praktikum-projects/frontend:latest`

### ‚úÖ Nginx
- –ö–∞—Å—Ç–æ–º–Ω—ã–π –æ–±—Ä–∞–∑ –Ω–∞ –±–∞–∑–µ `nginx:alpine`
- –ü–æ–¥–º–µ–Ω—è–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `nginx.conf`
- –ù–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞:
  - –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏ —Å `/usr/share/nginx/html`
  - –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ `/api/**` –Ω–∞ –≤–Ω–µ—à–Ω–∏–π backend (–Ω–∞–ø—Ä–∏–º–µ—Ä, `backend.praktikum-services.tech:8080`)

---

## üîÑ CI/CD Pipeline (GitLab CI)

–ü–∞–π–ø–ª–∞–π–Ω –≤ `.gitlab-ci.yml` –≤—ã–ø–æ–ª–Ω—è–µ—Ç:

1. **–°–±–æ—Ä–∫—É –∏ –ø—É—à –æ–±—Ä–∞–∑–æ–≤**:
   - `frontend`
   - `nginx`

2. **–î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ SSH**:
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —É–¥–∞–ª—ë–Ω–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É –ø–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º—É –∫–ª—é—á—É
   - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ `deploy.sh`

```yaml

deploy:
  stage: deploy
  script:
    - chmod 600 $SSH_KEY
    - ssh -o StrictHostKeyChecking=no -i $SSH_KEY user@$SERVER_IP "cd /opt/sausage && ./deploy.sh"
  environment: production
  only:
    - docker